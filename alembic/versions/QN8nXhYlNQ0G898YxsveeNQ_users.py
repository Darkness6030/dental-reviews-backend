from alembic import op
from sqlalchemy import true
from sqlalchemy.sql.schema import Column, ForeignKeyConstraint, Index, MetaData, PrimaryKeyConstraint, Table
from sqlalchemy.sql.sqltypes import Boolean, DateTime, Float, Integer
from sqlmodel.sql.sqltypes import AutoString

# revision identifiers, used by Alembic.
revision = 'QN8nXhYlNQ0G898YxsveeNQ'
down_revision = 'Dtk_wNInPTqKg_ydWo26Q'
branch_labels = None
depends_on = None


def upgrade() -> None:
    # ### commands auto generated by rewire_sqlmodel - please adjust! ###
    op.drop_table('owner')
    with op.batch_alter_table('user', schema=None) as batch_op:
        batch_op.add_column(
            Column(
                'avatar_url',
                AutoString(),
                nullable=True,
            ),
        )
        batch_op.add_column(
            Column(
                'is_owner',
                Boolean(),
                nullable=False,
                server_default=true()
            ),
        )
    # ### end Alembic commands ###


def downgrade() -> None:
    # ### commands auto generated by rewire_sqlmodel - please adjust! ###
    op.create_table(
        'owner',
        Column(
            'id',
            Integer(),
            primary_key=True,
            nullable=False,
        ),
        Column(
            'name',
            AutoString(),
            nullable=False,
        ),
        Column(
            'title',
            AutoString(),
            nullable=False,
        ),
        Column(
            'avatar_url',
            AutoString(),
            nullable=True,
        ),
        PrimaryKeyConstraint(
            'id',
        ),
    )
    with op.batch_alter_table('user', schema=None) as batch_op:
        batch_op.drop_column('avatar_url')
        batch_op.drop_column('is_owner')
    # ### end Alembic commands ###


_Meta = MetaData()
schema = {
    'aspect': Table(
        'aspect',
        _Meta,
        Column(
            'id',
            Integer(),
            primary_key=True,
            nullable=False,
        ),
        Column(
            'position',
            Integer(),
            nullable=False,
        ),
        Column(
            'is_enabled',
            Boolean(),
            nullable=False,
        ),
        Column(
            'name',
            AutoString(),
            nullable=False,
        ),
        PrimaryKeyConstraint(
            'id',
        ),
        Index(
            'ix_aspect_position',
            'position',
            unique=False,
        ),
    ),
    'complaint': Table(
        'complaint',
        _Meta,
        Column(
            'id',
            Integer(),
            primary_key=True,
            nullable=False,
        ),
        Column(
            'created_at',
            DateTime(),
            nullable=False,
        ),
        Column(
            'contact_name',
            AutoString(),
            nullable=True,
        ),
        Column(
            'contact_phone',
            AutoString(),
            nullable=True,
        ),
        Column(
            'complaint_text',
            AutoString(),
            nullable=True,
        ),
        PrimaryKeyConstraint(
            'id',
        ),
    ),
    'doctor': Table(
        'doctor',
        _Meta,
        Column(
            'id',
            Integer(),
            primary_key=True,
            nullable=False,
        ),
        Column(
            'position',
            Integer(),
            nullable=False,
        ),
        Column(
            'is_enabled',
            Boolean(),
            nullable=False,
        ),
        Column(
            'name',
            AutoString(),
            nullable=False,
        ),
        Column(
            'role',
            AutoString(),
            nullable=False,
        ),
        Column(
            'avatar_url',
            AutoString(),
            nullable=True,
        ),
        PrimaryKeyConstraint(
            'id',
        ),
        Index(
            'ix_doctor_position',
            'position',
            unique=False,
        ),
    ),
    'platform': Table(
        'platform',
        _Meta,
        Column(
            'id',
            Integer(),
            primary_key=True,
            nullable=False,
        ),
        Column(
            'position',
            Integer(),
            nullable=False,
        ),
        Column(
            'is_enabled',
            Boolean(),
            nullable=False,
        ),
        Column(
            'name',
            AutoString(),
            nullable=False,
        ),
        Column(
            'url',
            AutoString(),
            nullable=False,
        ),
        Column(
            'image_url',
            AutoString(),
            nullable=True,
        ),
        PrimaryKeyConstraint(
            'id',
        ),
        Index(
            'ix_platform_position',
            'position',
            unique=False,
        ),
    ),
    'prompt': Table(
        'prompt',
        _Meta,
        Column(
            'id',
            AutoString(),
            primary_key=True,
            nullable=False,
        ),
        Column(
            'created_at',
            DateTime(),
            nullable=False,
        ),
        Column(
            'prompt_text',
            AutoString(),
            nullable=False,
        ),
        Column(
            'temperature',
            Float(),
            nullable=False,
        ),
        Column(
            'frequency_penalty',
            Float(),
            nullable=False,
        ),
        PrimaryKeyConstraint(
            'id',
        ),
    ),
    'reason': Table(
        'reason',
        _Meta,
        Column(
            'id',
            Integer(),
            primary_key=True,
            nullable=False,
        ),
        Column(
            'position',
            Integer(),
            nullable=False,
        ),
        Column(
            'is_enabled',
            Boolean(),
            nullable=False,
        ),
        Column(
            'name',
            AutoString(),
            nullable=False,
        ),
        PrimaryKeyConstraint(
            'id',
        ),
        Index(
            'ix_reason_position',
            'position',
            unique=False,
        ),
    ),
    'review': Table(
        'review',
        _Meta,
        Column(
            'id',
            Integer(),
            primary_key=True,
            nullable=False,
        ),
        Column(
            'created_at',
            DateTime(),
            nullable=False,
        ),
        Column(
            'contact_name',
            AutoString(),
            nullable=True,
        ),
        Column(
            'contact_phone',
            AutoString(),
            nullable=True,
        ),
        Column(
            'review_text',
            AutoString(),
            nullable=True,
        ),
        PrimaryKeyConstraint(
            'id',
        ),
    ),
    'reward': Table(
        'reward',
        _Meta,
        Column(
            'id',
            Integer(),
            primary_key=True,
            nullable=False,
        ),
        Column(
            'position',
            Integer(),
            nullable=False,
        ),
        Column(
            'is_enabled',
            Boolean(),
            nullable=False,
        ),
        Column(
            'name',
            AutoString(),
            nullable=False,
        ),
        Column(
            'image_url',
            AutoString(),
            nullable=True,
        ),
        PrimaryKeyConstraint(
            'id',
        ),
        Index(
            'ix_reward_position',
            'position',
            unique=False,
        ),
    ),
    'service': Table(
        'service',
        _Meta,
        Column(
            'id',
            Integer(),
            primary_key=True,
            nullable=False,
        ),
        Column(
            'position',
            Integer(),
            nullable=False,
        ),
        Column(
            'is_enabled',
            Boolean(),
            nullable=False,
        ),
        Column(
            'name',
            AutoString(),
            nullable=False,
        ),
        Column(
            'category',
            AutoString(),
            nullable=False,
        ),
        PrimaryKeyConstraint(
            'id',
        ),
        Index(
            'ix_service_position',
            'position',
            unique=False,
        ),
    ),
    'source': Table(
        'source',
        _Meta,
        Column(
            'id',
            Integer(),
            primary_key=True,
            nullable=False,
        ),
        Column(
            'position',
            Integer(),
            nullable=False,
        ),
        Column(
            'is_enabled',
            Boolean(),
            nullable=False,
        ),
        Column(
            'name',
            AutoString(),
            nullable=False,
        ),
        PrimaryKeyConstraint(
            'id',
        ),
        Index(
            'ix_source_position',
            'position',
            unique=False,
        ),
    ),
    'user': Table(
        'user',
        _Meta,
        Column(
            'id',
            Integer(),
            primary_key=True,
            nullable=False,
        ),
        Column(
            'name',
            AutoString(),
            nullable=False,
        ),
        Column(
            'username',
            AutoString(),
            nullable=False,
        ),
        Column(
            'password_hash',
            AutoString(),
            nullable=False,
        ),
        Column(
            'is_admin',
            Boolean(),
            nullable=False,
        ),
        Column(
            'is_owner',
            Boolean(),
            nullable=False,
        ),
        Column(
            'avatar_url',
            AutoString(),
            nullable=True,
        ),
        Column(
            'telegram_id',
            Integer(),
            nullable=True,
        ),
        PrimaryKeyConstraint(
            'id',
        ),
    ),
    'complaintreasonlink': Table(
        'complaintreasonlink',
        _Meta,
        Column(
            'complaint_id',
            Integer(),
            primary_key=True,
            nullable=False,
        ),
        Column(
            'reason_id',
            Integer(),
            primary_key=True,
            nullable=False,
        ),
        PrimaryKeyConstraint(
            'complaint_id',
            'reason_id',
        ),
        ForeignKeyConstraint(
            ['complaint_id'],
            [
                'complaint.id',
            ],
            name='fk_complaintreasonlink_complaint_id_complaint',
        ),
        ForeignKeyConstraint(
            ['reason_id'],
            [
                'reason.id',
            ],
            name='fk_complaintreasonlink_reason_id_reason',
        ),
    ),
    'doctorservicelink': Table(
        'doctorservicelink',
        _Meta,
        Column(
            'doctor_id',
            Integer(),
            primary_key=True,
            nullable=False,
        ),
        Column(
            'service_id',
            Integer(),
            primary_key=True,
            nullable=False,
        ),
        ForeignKeyConstraint(
            ['doctor_id'],
            [
                'doctor.id',
            ],
            name='fk_doctorservicelink_doctor_id_doctor',
        ),
        PrimaryKeyConstraint(
            'doctor_id',
            'service_id',
        ),
        ForeignKeyConstraint(
            ['service_id'],
            [
                'service.id',
            ],
            name='fk_doctorservicelink_service_id_service',
        ),
    ),
    'reviewaspectlink': Table(
        'reviewaspectlink',
        _Meta,
        Column(
            'review_id',
            Integer(),
            primary_key=True,
            nullable=False,
        ),
        Column(
            'aspect_id',
            Integer(),
            primary_key=True,
            nullable=False,
        ),
        ForeignKeyConstraint(
            ['aspect_id'],
            [
                'aspect.id',
            ],
            name='fk_reviewaspectlink_aspect_id_aspect',
        ),
        ForeignKeyConstraint(
            ['review_id'],
            [
                'review.id',
            ],
            name='fk_reviewaspectlink_review_id_review',
        ),
        PrimaryKeyConstraint(
            'review_id',
            'aspect_id',
        ),
    ),
    'reviewdoctorlink': Table(
        'reviewdoctorlink',
        _Meta,
        Column(
            'review_id',
            Integer(),
            primary_key=True,
            nullable=False,
        ),
        Column(
            'doctor_id',
            Integer(),
            primary_key=True,
            nullable=False,
        ),
        PrimaryKeyConstraint(
            'review_id',
            'doctor_id',
        ),
        ForeignKeyConstraint(
            ['doctor_id'],
            [
                'doctor.id',
            ],
            name='fk_reviewdoctorlink_doctor_id_doctor',
        ),
        ForeignKeyConstraint(
            ['review_id'],
            [
                'review.id',
            ],
            name='fk_reviewdoctorlink_review_id_review',
        ),
    ),
    'reviewplatformlink': Table(
        'reviewplatformlink',
        _Meta,
        Column(
            'review_id',
            Integer(),
            primary_key=True,
            nullable=False,
        ),
        Column(
            'platform_id',
            Integer(),
            primary_key=True,
            nullable=False,
        ),
        PrimaryKeyConstraint(
            'review_id',
            'platform_id',
        ),
        ForeignKeyConstraint(
            ['platform_id'],
            [
                'platform.id',
            ],
            name='fk_reviewplatformlink_platform_id_platform',
        ),
        ForeignKeyConstraint(
            ['review_id'],
            [
                'review.id',
            ],
            name='fk_reviewplatformlink_review_id_review',
        ),
    ),
    'reviewrewardlink': Table(
        'reviewrewardlink',
        _Meta,
        Column(
            'review_id',
            Integer(),
            primary_key=True,
            nullable=False,
        ),
        Column(
            'reward_id',
            Integer(),
            primary_key=True,
            nullable=False,
        ),
        ForeignKeyConstraint(
            ['review_id'],
            [
                'review.id',
            ],
            name='fk_reviewrewardlink_review_id_review',
        ),
        ForeignKeyConstraint(
            ['reward_id'],
            [
                'reward.id',
            ],
            name='fk_reviewrewardlink_reward_id_reward',
        ),
        PrimaryKeyConstraint(
            'review_id',
            'reward_id',
        ),
    ),
    'reviewservicelink': Table(
        'reviewservicelink',
        _Meta,
        Column(
            'review_id',
            Integer(),
            primary_key=True,
            nullable=False,
        ),
        Column(
            'service_id',
            Integer(),
            primary_key=True,
            nullable=False,
        ),
        ForeignKeyConstraint(
            ['review_id'],
            [
                'review.id',
            ],
            name='fk_reviewservicelink_review_id_review',
        ),
        PrimaryKeyConstraint(
            'review_id',
            'service_id',
        ),
        ForeignKeyConstraint(
            ['service_id'],
            [
                'service.id',
            ],
            name='fk_reviewservicelink_service_id_service',
        ),
    ),
    'reviewsourcelink': Table(
        'reviewsourcelink',
        _Meta,
        Column(
            'review_id',
            Integer(),
            primary_key=True,
            nullable=False,
        ),
        Column(
            'source_id',
            Integer(),
            primary_key=True,
            nullable=False,
        ),
        ForeignKeyConstraint(
            ['source_id'],
            [
                'source.id',
            ],
            name='fk_reviewsourcelink_source_id_source',
        ),
        PrimaryKeyConstraint(
            'review_id',
            'source_id',
        ),
        ForeignKeyConstraint(
            ['review_id'],
            [
                'review.id',
            ],
            name='fk_reviewsourcelink_review_id_review',
        ),
    ),
}
